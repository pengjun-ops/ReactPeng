import echarts from "echarts/lib/echarts";
import 'echarts/map/js/province/jiangsu';
import 'echarts/map/js/china';
import React, {Component} from "react";

export default class Location extends Component {
constructor(props) {
    super(props);
    this.state = {};
}

componentDidMount() {
    const data = [{ name: '福运路',      value: 68962293},
                  { name: '曹庄',        value: 43323658 },
                  { name: '坝基桥',      value: 8333625.5},
                  { name: '王家庄',      value: 52791584},
                  { name: '苏旺路',      value: 29849274.83},
                  { name: '东山大道',    value: 14074942},];
    const geoCoordMap = {
        '福运路': [120.596697,31.314577],
        '曹庄': [120.647182,31.39678],
        '坝基桥': [120.31745,31.195686],
        '王家庄': [120.758491,31.46165],
        '苏旺路': [120.21745,31.275686],
        '东山大道': [120.31745,30.995686],
    };

    const convertData = function(data) {
        let res = [];
        for (let i = 0; i < data.length; i++) {
            let geoCoord = geoCoordMap[data[i].name];
            if (geoCoord) {
                res.push({
                    name : data[i].name,
                    value : geoCoord.concat(data[i].value)
                });
            }
        }
        return res;
    };
const myChart = echarts.init(document.getElementById('location'));
    myChart.showLoading();
    const DATA = JSON.parse(
        `{"type":"FeatureCollection",
        "features":[
        {"type":"Feature",
        "properties":{"adcode":320506,
        "name":"吴中区",
        "center":[120.624621,31.270839],
        "centroid":[120.32038,31.143132],
        "childrenNum":0,
        "level":"district",
        "parent":{"adcode":320500},
        "subFeatureIndex":1,
        "acroutes":[100000,320000,320500]},
        "geometry":{"type":"MultiPolygon","coordinates":[[[[120.864794,31.309848],[120.868076,31.304872],[120.869514,31.30081],[120.870995,31.299108],[120.871024,31.292544],[120.872114,31.291616],[120.877647,31.290816],[120.879229,31.284072],[120.881306,31.284136],[120.881016,31.282343],[120.884109,31.282601],[120.884327,31.280099],[120.880624,31.280267],[120.880696,31.278268],[120.883833,31.278332],[120.882758,31.275843],[120.880725,31.275779],[120.880769,31.271432],[120.884515,31.271213],[120.88119,31.268414],[120.881931,31.26386],[120.885459,31.255114],[120.887347,31.252173],[120.890063,31.251863],[120.891704,31.249838],[120.891413,31.248212],[120.888524,31.24709],[120.887652,31.245038],[120.888538,31.238355],[120.892546,31.239374],[120.897034,31.236484],[120.898558,31.232703],[120.901187,31.230394],[120.901376,31.226509],[120.898863,31.224445],[120.900955,31.221425],[120.901289,31.218908],[120.898326,31.217476],[120.896032,31.214482],[120.891689,31.213669],[120.881872,31.209809],[120.879186,31.209255],[120.871881,31.21172],[120.861411,31.211836],[120.855718,31.207293],[120.848239,31.204311],[120.844013,31.1996],[120.842721,31.197212],[120.842082,31.192164],[120.839628,31.189234],[120.831466,31.190396],[120.827458,31.190099],[120.821272,31.187917],[120.81844,31.185929],[120.816334,31.180881],[120.815913,31.173573],[120.794464,31.182224],[120.793346,31.184018],[120.793709,31.187375],[120.788974,31.189582],[120.776965,31.193416],[120.774685,31.195095],[120.773712,31.199535],[120.775193,31.202581],[120.777574,31.204414],[120.780014,31.209874],[120.779913,31.211152],[120.775904,31.214417],[120.770502,31.217631],[120.765318,31.219657],[120.760395,31.222548],[120.754746,31.223167],[120.751667,31.215901],[120.749024,31.213139],[120.747485,31.209629],[120.744101,31.204337],[120.738568,31.198115],[120.734008,31.191958],[120.724162,31.183334],[120.721388,31.185245],[120.717569,31.192255],[120.717337,31.199961],[120.697921,31.201872],[120.695466,31.201562],[120.690311,31.198774],[120.685301,31.196876],[120.68167,31.196515],[120.677401,31.192435],[120.677473,31.188743],[120.675992,31.187143],[120.673698,31.187995],[120.671795,31.193055],[120.670401,31.194849],[120.664607,31.195443],[120.664679,31.200632],[120.663503,31.205731],[120.661267,31.208971],[120.66041,31.219231],[120.65935,31.220238],[120.655981,31.220289],[120.65418,31.219037],[120.65158,31.219166],[120.650114,31.221476],[120.643332,31.220909],[120.641604,31.224599],[120.641415,31.229335],[120.639324,31.229826],[120.63639,31.228109],[120.634996,31.225503],[120.631249,31.224793],[120.634488,31.210919],[120.626051,31.208222],[120.62441,31.206273],[120.622696,31.201304],[120.622914,31.194643],[120.624192,31.184715],[120.623742,31.176879],[120.614375,31.168396],[120.608479,31.160041],[120.599548,31.160816],[120.595598,31.157497],[120.593971,31.156993],[120.590079,31.152357],[120.569095,31.116318],[120.561354,31.103592],[120.558726,31.101835],[120.557651,31.097932],[120.555415,31.09465],[120.540849,31.085836],[120.499926,31.062093],[120.491619,31.057685],[120.486667,31.053961],[120.48491,31.051492],[120.465247,31.027352],[120.462008,31.020291],[120.457942,31.014484],[120.447356,31.003723],[120.442694,30.998588],[120.437335,30.991369],[120.432993,30.984616],[120.428913,30.979027],[120.423205,30.973632],[120.418471,30.971458],[120.405256,30.967965],[120.399709,30.966011],[120.394466,30.962905],[120.386508,30.961352],[120.375471,30.955593],[120.372857,30.952345],[120.3711,30.94876],[120.364507,30.947129],[120.359264,30.944593],[120.351147,30.942561],[120.343334,30.939985],[120.340894,30.939959],[120.330975,30.937772],[120.322247,30.935209],[120.308074,30.93227],[120.299854,30.931649],[120.282515,30.929863],[120.274644,30.928193],[120.271376,30.928659],[120.266148,30.928244],[120.250755,30.926225],[120.241316,30.926497],[120.236581,30.926134],[120.223686,30.926691],[120.212315,30.929021],[120.206114,30.929759],[120.198795,30.928309],[120.195469,30.9306],[120.188586,30.93227],[120.178522,30.933862],[120.167369,30.935014],[120.149652,30.937474],[120.147212,30.938885],[120.145615,30.941357],[120.141883,30.943156],[120.13786,30.94326],[120.135144,30.941901],[120.129945,30.944981],[120.115118,30.954649],[120.111023,30.955917],[120.107088,30.959709],[120.107451,30.960627],[120.104357,30.963448],[120.103762,30.965105],[120.101642,30.964173],[120.099129,30.966347],[120.09441,30.973231],[120.086974,30.979674],[120.081238,30.983944],[120.072888,30.989041],[120.061328,30.99798],[120.056914,31.002649],[120.052441,31.005741],[120.045702,31.008185],[120.032531,31.011781],[120.017021,31.017795],[120.004692,31.024908],[120.001729,31.027119],[119.997605,31.034606],[119.998433,31.036184],[119.995572,31.043166],[119.99245,31.048299],[119.988514,31.059223],[119.982778,31.064924],[119.97209,31.07202],[119.969766,31.074282],[119.961431,31.087387],[119.953022,31.096782],[119.94624,31.106228],[119.947025,31.108941],[119.946589,31.112016],[119.940199,31.12863],[119.93988,31.134598],[119.940475,31.139584],[119.939822,31.142955],[119.936757,31.146558],[119.927928,31.152951],[119.921074,31.161216],[119.920275,31.164406],[119.920957,31.170384],[119.920013,31.170913],[120.110224,31.264002],[120.173715,31.308817],[120.206593,31.342565],[120.255693,31.300449],[120.263099,31.295239],[120.27142,31.291732],[120.283662,31.28963],[120.295469,31.289037],[120.306259,31.289449],[120.317876,31.291809],[120.334591,31.299946],[120.344626,31.305632],[120.348431,31.308585],[120.354312,31.311963],[120.355663,31.313317],[120.354327,31.315998],[120.354777,31.318461],[120.372073,31.318834],[120.374179,31.319943],[120.372552,31.322625],[120.37871,31.325938],[120.383647,31.325989],[120.385332,31.325306],[120.395802,31.324558],[120.39965,31.324752],[120.401989,31.323269],[120.404341,31.32479],[120.413171,31.324752],[120.416946,31.322663],[120.414841,31.320807],[120.415683,31.319853],[120.418137,31.321426],[120.419212,31.317494],[120.421651,31.315044],[120.421739,31.308778],[120.429798,31.304962],[120.428433,31.301906],[120.430713,31.300139],[120.435564,31.300101],[120.443406,31.298437],[120.446644,31.299998],[120.446775,31.303415],[120.444887,31.308391],[120.445729,31.311524],[120.450725,31.315482],[120.455648,31.318486],[120.459482,31.318035],[120.462691,31.314348],[120.472276,31.313755],[120.4738,31.312143],[120.481062,31.309835],[120.483559,31.302525],[120.483632,31.299907],[120.482078,31.296619],[120.483763,31.295175],[120.490951,31.295188],[120.492113,31.293911],[120.490704,31.288985],[120.492069,31.2854],[120.494233,31.284794],[120.497384,31.288482],[120.504849,31.288005],[120.51028,31.291048],[120.513489,31.29217],[120.522159,31.292776],[120.525122,31.289527],[120.526167,31.287167],[120.529144,31.285219],[120.530379,31.279364],[120.53215,31.277056],[120.532949,31.272567],[120.538787,31.271613],[120.541808,31.268388],[120.546527,31.267085],[120.548023,31.268775],[120.552452,31.271303],[120.553774,31.270968],[120.555342,31.267421],[120.556765,31.267111],[120.56012,31.270542],[120.562255,31.270452],[120.563925,31.26822],[120.564419,31.263499],[120.566655,31.261797],[120.566582,31.260197],[120.564099,31.257772],[120.56163,31.257191],[120.564607,31.254198],[120.566553,31.251128],[120.569313,31.249167],[120.567802,31.246238],[120.568949,31.245206],[120.567686,31.2366],[120.572914,31.233116],[120.576269,31.22851],[120.578287,31.22349],[120.5782,31.218547],[120.587349,31.218753],[120.587799,31.221373],[120.594233,31.225942],[120.592664,31.228819],[120.594218,31.22989],[120.594697,31.234819],[120.593608,31.240716],[120.593347,31.249593],[120.596745,31.249515],[120.599272,31.252728],[120.602655,31.253037],[120.602713,31.256533],[120.609466,31.257165],[120.610033,31.259539],[120.608392,31.264002],[120.609655,31.266582],[120.61481,31.268465],[120.614418,31.272735],[120.612313,31.27387],[120.612748,31.275766],[120.621491,31.276901],[120.632716,31.277881],[120.635156,31.275727],[120.634793,31.273496],[120.641531,31.273251],[120.644755,31.273896],[120.644741,31.271587],[120.646846,31.270465],[120.650114,31.271032],[120.648763,31.276101],[120.649257,31.277339],[120.652582,31.278074],[120.652931,31.279442],[120.654093,31.276514],[120.656968,31.274063],[120.660802,31.274966],[120.663489,31.265847],[120.666074,31.259874],[120.671577,31.259965],[120.672638,31.263228],[120.672216,31.267524],[120.67332,31.270465],[120.671824,31.272412],[120.670822,31.276346],[120.672173,31.278655],[120.674191,31.279596],[120.675281,31.282498],[120.675571,31.287025],[120.676747,31.290146],[120.680973,31.289914],[120.717061,31.25354],[120.716988,31.248419],[120.720735,31.2442],[120.728461,31.237736],[120.732992,31.236407],[120.738626,31.235619],[120.741342,31.23629],[120.745727,31.238755],[120.752161,31.237839],[120.755123,31.235916],[120.759901,31.234626],[120.763343,31.23651],[120.770706,31.246587],[120.772695,31.256701],[120.775585,31.266208],[120.783543,31.26844],[120.805007,31.26782],[120.805181,31.271393],[120.801086,31.277662],[120.798791,31.279583],[120.802349,31.284033],[120.807984,31.293808],[120.819471,31.292106],[120.828286,31.290094],[120.836346,31.286432],[120.840673,31.281647],[120.845829,31.282137],[120.85126,31.291461],[120.85322,31.297367],[120.857098,31.30491],[120.864794,31.309848]]]]}},
        
        {"type":"Feature",
        "properties":{"adcode":320507,
        "name":"相城区",
        "center":[120.618956,31.396684],
        "centroid":[120.631082,31.44481],
        "childrenNum":0,
        "level":"district",
        "parent":{"adcode":320500},
        "subFeatureIndex":2,
        "acroutes":[100000,320000,320500]},
        "geometry":{"type":"MultiPolygon","coordinates":[[[[120.644871,31.335927],[120.643753,31.336946],[120.636303,31.335554],[120.634967,31.337513],[120.634793,31.341135],[120.631772,31.347179],[120.627677,31.346586],[120.626138,31.348223],[120.620982,31.348378],[120.619341,31.34986],[120.616539,31.349615],[120.615798,31.34629],[120.611645,31.345955],[120.610091,31.353907],[120.60874,31.356561],[120.597413,31.356871],[120.590587,31.357386],[120.590747,31.359409],[120.586681,31.359512],[120.584779,31.357347],[120.577648,31.357012],[120.574962,31.36218],[120.57059,31.366574],[120.570503,31.368094],[120.57258,31.370645],[120.571897,31.371805],[120.562298,31.374292],[120.556635,31.376765],[120.554122,31.379136],[120.552452,31.381326],[120.551102,31.386235],[120.547529,31.389623],[120.550376,31.390305],[120.552888,31.393642],[120.550928,31.39542],[120.549606,31.39949],[120.555008,31.400868],[120.557201,31.402388],[120.558131,31.404681],[120.560251,31.405402],[120.5624,31.407669],[120.563475,31.411056],[120.562865,31.413181],[120.556373,31.41434],[120.55299,31.420612],[120.547733,31.41917],[120.546629,31.416478],[120.543637,31.414289],[120.535549,31.413426],[120.530321,31.410412],[120.525456,31.406329],[120.519821,31.404848],[120.516684,31.403045],[120.513489,31.403367],[120.510527,31.401164],[120.508988,31.401705],[120.504413,31.407141],[120.500347,31.410077],[120.49644,31.411211],[120.491082,31.411108],[120.488134,31.408983],[120.486333,31.409382],[120.47836,31.41698],[120.470882,31.411455],[120.476327,31.406304],[120.475209,31.405029],[120.471448,31.404462],[120.469865,31.402427],[120.465349,31.402311],[120.465552,31.395935],[120.463083,31.394904],[120.459845,31.397184],[120.453629,31.394556],[120.452555,31.39636],[120.44843,31.396862],[120.445991,31.39189],[120.440951,31.389417],[120.437016,31.390447],[120.433385,31.393243],[120.429159,31.394028],[120.420896,31.390267],[120.418892,31.393165],[120.411893,31.396514],[120.40832,31.396849],[120.405387,31.398666],[120.392157,31.399915],[120.317586,31.398125],[120.33555,31.40736],[120.355823,31.416452],[120.41882,31.448386],[120.422639,31.448991],[120.426589,31.445437],[120.430539,31.44639],[120.434997,31.442605],[120.437481,31.443043],[120.43173,31.448643],[120.438178,31.448772],[120.460179,31.445489],[120.474439,31.44657],[120.480553,31.449132],[120.485418,31.449905],[120.484794,31.447484],[120.48703,31.448617],[120.495758,31.447935],[120.495424,31.451089],[120.501407,31.457551],[120.505038,31.457963],[120.508537,31.455646],[120.512357,31.457088],[120.513853,31.456187],[120.517367,31.457822],[120.515973,31.460229],[120.516002,31.464425],[120.523844,31.468364],[120.526022,31.468338],[120.531105,31.466613],[120.536159,31.467103],[120.537306,31.468364],[120.543565,31.470269],[120.546368,31.473126],[120.550724,31.475906],[120.554108,31.476241],[120.555241,31.480295],[120.553004,31.48673],[120.549083,31.489175],[120.548038,31.495081],[120.548502,31.497397],[120.551625,31.50064],[120.555197,31.507575],[120.559859,31.508964],[120.568543,31.512374],[120.576922,31.517507],[120.585781,31.524531],[120.589832,31.526962],[120.592766,31.527553],[120.593986,31.525495],[120.595641,31.517147],[120.598575,31.516169],[120.600027,31.518613],[120.60235,31.518986],[120.605763,31.525238],[120.604195,31.532094],[120.605124,31.535683],[120.602917,31.538268],[120.602815,31.541175],[120.605022,31.546075],[120.613402,31.545869],[120.613126,31.550036],[120.616713,31.54965],[120.619966,31.550846],[120.621984,31.547091],[120.62698,31.545354],[120.62698,31.541959],[120.628969,31.538615],[120.628708,31.532287],[120.62653,31.525791],[120.627198,31.525405],[120.635853,31.525251],[120.637668,31.524235],[120.636085,31.517764],[120.638685,31.516773],[120.643361,31.516516],[120.643187,31.512567],[120.646962,31.510418],[120.647863,31.506726],[120.655603,31.503509],[120.655022,31.49961],[120.656532,31.496419],[120.66086,31.495866],[120.663372,31.498632],[120.679129,31.497835],[120.680552,31.499675],[120.68472,31.499443],[120.685214,31.497217],[120.69124,31.496574],[120.694261,31.495351],[120.697964,31.498401],[120.697122,31.499495],[120.702756,31.509903],[120.70659,31.513274],[120.707157,31.518343],[120.709437,31.519784],[120.724206,31.519424],[120.728417,31.521919],[120.729114,31.527052],[120.735649,31.527605],[120.735417,31.536236],[120.739759,31.535618],[120.747441,31.531348],[120.753671,31.529329],[120.757723,31.52902],[120.762471,31.53001],[120.762922,31.534384],[120.764621,31.539747],[120.767917,31.539863],[120.774757,31.535644],[120.776834,31.533766],[120.780668,31.531862],[120.781539,31.529033],[120.783645,31.528441],[120.787987,31.529933],[120.789483,31.529586],[120.788132,31.525855],[120.790368,31.52435],[120.797165,31.523926],[120.799503,31.521585],[120.804615,31.52161],[120.805355,31.525624],[120.808652,31.530975],[120.808681,31.536171],[120.810699,31.535811],[120.81404,31.53302],[120.820879,31.533393],[120.821649,31.534782],[120.825962,31.534628],[120.828562,31.525958],[120.829375,31.519951],[120.815347,31.519655],[120.807664,31.513724],[120.807868,31.503458],[120.808318,31.502879],[120.81767,31.503831],[120.814272,31.492791],[120.814664,31.491208],[120.818396,31.489033],[120.822245,31.48359],[120.824263,31.475816],[120.824103,31.468815],[120.825396,31.46467],[120.827487,31.444266],[120.830333,31.434905],[120.824118,31.435871],[120.783804,31.429613],[120.773,31.427283],[120.762791,31.417946],[120.749387,31.412151],[120.737537,31.404101],[120.730784,31.395883],[120.728533,31.389661],[120.723029,31.384856],[120.718891,31.384405],[120.707897,31.388785],[120.701842,31.383761],[120.701842,31.388747],[120.700912,31.391066],[120.695031,31.391143],[120.695263,31.383143],[120.671098,31.363043],[120.664258,31.358121],[120.655589,31.350775],[120.648197,31.344086],[120.649707,31.336147],[120.644871,31.335927]]]]}},
        
        {"type":"Feature",
        "properties":{"adcode":320508,
        "name":"姑苏区",
        "center":[120.622249,31.311414],
        "centroid":[120.597994,31.318955],
        "childrenNum":0,
        "level":"district",
        "parent":{"adcode":320500},
        "subFeatureIndex":3,
        "acroutes":[100000,320000,320500]},
        "geometry":{"type":"MultiPolygon","coordinates":[[[[120.554122,31.379136],[120.556635,31.376765],[120.562298,31.374292],[120.571897,31.371805],[120.57258,31.370645],[120.570503,31.368094],[120.57059,31.366574],[120.574962,31.36218],[120.577648,31.357012],[120.584779,31.357347],[120.586681,31.359512],[120.590747,31.359409],[120.590587,31.357386],[120.597413,31.356871],[120.60874,31.356561],[120.610091,31.353907],[120.611645,31.345955],[120.615798,31.34629],[120.616539,31.349615],[120.619341,31.34986],[120.620982,31.348378],[120.626138,31.348223],[120.627677,31.346586],[120.631772,31.347179],[120.634793,31.341135],[120.634967,31.337513],[120.636303,31.335554],[120.643753,31.336946],[120.644871,31.335927],[120.640878,31.335347],[120.642417,31.330217],[120.645917,31.325989],[120.654572,31.295562],[120.655138,31.289656],[120.652931,31.279442],[120.652582,31.278074],[120.649257,31.277339],[120.648763,31.276101],[120.650114,31.271032],[120.646846,31.270465],[120.644741,31.271587],[120.644755,31.273896],[120.641531,31.273251],[120.634793,31.273496],[120.635156,31.275727],[120.632716,31.277881],[120.621491,31.276901],[120.612748,31.275766],[120.612313,31.27387],[120.614418,31.272735],[120.61481,31.268465],[120.609655,31.266582],[120.608392,31.264002],[120.610033,31.259539],[120.593419,31.259849],[120.59143,31.260261],[120.588467,31.262816],[120.586231,31.273264],[120.580582,31.281789],[120.575789,31.292712],[120.56953,31.305503],[120.56664,31.308881],[120.565508,31.315934],[120.563184,31.321503],[120.560498,31.324494],[120.534634,31.349886],[120.528636,31.35553],[120.529043,31.356793],[120.540152,31.361974],[120.539905,31.37004],[120.540864,31.372707],[120.547355,31.375696],[120.550419,31.378505],[120.554122,31.379136]]]]}}
        
        ]}`
    );
    myChart.hideLoading();
    echarts.registerMap("SZ", DATA);

    myChart.setOption({
        title : {
            text : '苏州市燃气门站分布',
            subtext : 'Gas Location',
            link:'/location',
            left : 'center',
            textStyle : {
                color:'#9aa8d4',
            }
        },
        tooltip: {
            trigger: "item",
        },
        legend : {
            orient : 'vertical',
            y : 'bottom',
            x : 'right',
            data : [ 'gas' ],
            textStyle : {
                color : '#eaeaea'
            }
        },
        visualMap: {
            min: 8300000,
            max: 69000000,
            text: ["High", "Low"],
            realtime: false,
            calculable: true,
            inRange: {
                color: ["green", "yellow", "orangered"],
            },
        },
        geo : {
            map : 'SZ',
            center: [120.4,31.3],
            zoom: 1.5,
            label : {
                normal : {
                    show:true
                },
                emphasis : {
                    show : false
                }
            },
            roam : true,
            itemStyle : {
                normal : {
                    areaColor : '#D5EEFD',
                    borderColor : '#000000'
                },
                emphasis : {
                    areaColor : '#00dfff',
                }
            }
        },
        series : [ {
            name : '门站流量 (单位：2000000 供)',
            type : 'effectScatter',
            coordinateSystem : 'geo',
            data : convertData(data),
            symbolSize : function(val) {
                return val[2] / 2000000;
            },
            zoom: 2, //当前视角的缩放比例
            roam: true, //是否开启平游或缩放
            scaleLimit: { //滚轮缩放的极限控制
                min: 1,
                max: 3,
            },
            showEffectOn : 'render',
            rippleEffect : {
                brushType : 'stroke'
            },
            hoverAnimation : true,
            label : {
                normal : {
                    formatter : '{b}',
                    position : 'right',
                    show : true
                }
            },
            itemStyle : {
                normal : {
                    color : '#f4e925',
                    shadowBlur : 10,
                    shadowColor : '#00dfff'
                }
            },
            zlevel : 1
        } ]

    });
}

    render() {
        return (
            <div id="location" className="chart-loader"/>
        );
    }
}